#-*- coding:utf-8 -*-
import os
import sys
from collections import defaultdict
savepath = os.path.join(sys.path[0], 'config')

maps = list()
model_id = -10000
# [model_id: maps]
mappings = defaultdict(list)

update_all = False

context = defaultdict(int)
# online dictionary cache to avoid duplicate query
online_cache = defaultdict(str)

available_youdao_fields = ['phonetic', 'explains', 'collins', 'ec21', 'ee', 'web_trans', 'rel_word',
                           'syno', 'blng_sents_part', 'auth_sents_part', 'baike']

youdao_css = '''
<style type="text/css">
    @charset "utf-8";a,a:active,a:hover{color:#138bff}.btn,a{cursor:pointer}.btn,.search-bar .btn,body{font-size:14px}.copy,.nav-label .nav,.page,.page a{text-align:center}.emphasis,b,h4,h5{font-weight:400}.baike_detail .content,.collins h4 .title,.ec h2 span,.fanyi,strong{word-wrap:break-word}html{-webkit-text-size-adjust:none}body{background-color:#fff;font-family:"Times New Roman",Times,serif;line-height:21px}.collins h4 .phonetic,.ec .phonetic{font-family:"lucida sans unicode",arial,sans-serif}body,div,h1,h2,h3,h4,h5,input,li,ol,p,textarea,ul{margin:0;padding:0;outline:0}li,ol,ul{list-style:none}input{-webkit-appearance:none}a{text-decoration:none}strong{color:#c50000}#bd{background:#f4f4f4;padding:7px 0}.p-index_entry #bd{background:#fff;padding:0}.p-index #hd{border-bottom:1px solid #e8e8e8}.content-wrp{margin:7px}#ft{padding:7px 0;background:#fff}.empty-content{background:#FFF;padding:35px 7px;vertical-align:middle}.btn{border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px;-o-border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;padding:11px 35px;display:inline-block;white-space:nowrap;vertical-align:top;border:1px solid #076ccc;background-image:none;background-color:#0082ff;background:-webkit-gradient(linear,left top,left bottom,from(#0082ff),to(#0082ff));background:-webkit-linear-gradient(top,#0082ff,#0082ff);background:-moz-linear-gradient(top,#0082ff,#0082ff);background:-o-linear-gradient(top,#0082ff,#0082ff)}.nav-label{background-color:#fff;border-bottom:1px solid #e0e0e0;display:table;width:100%}.nav-label:after,.nav-label:before{content:" ";display:table}.nav-label:after{clear:both}.nav-label .logo{display:table-cell;width:1%;vertical-align:middle;padding:11px 7px}.nav-label .nav{display:table;width:100%}.nav-label .nav li{display:table-cell}.nav-label .nav li.active{border-bottom:3px solid #0082ff}.nav-label .nav a{display:inline-block;padding:11px 7px;color:#646464;position:relative}.search-area{background:#fff;position:relative}.search-bar{position:relative;display:table;border-collapse:separate;width:100%;padding:11px 7px 7px;box-sizing:border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box}.search-area .clearInput{position:absolute;top:14px;right:57px;width:34px;height:0;padding-top:34px;overflow:hidden;background:url(http://shared.ydstatic.com/dict/youdaowap/changeImg/close.png) no-repeat;background-size:100%;display:none}#dictNav,#dictNavList{position:absolute;right:7px}.search-bar .form-control{display:table-cell;padding:11px 7px;border:1px solid #d9d9d9;border-top-color:silver;background-image:none;vertical-align:top;width:99%;font-size:14px;border-radius:0}.search-bar .input-group-btn{display:table-cell;width:1%;vertical-align:top}.search-bar .btn{border-radius:0 4px 4px 0;-webkit-border-radius:0 4px 4px 0;-moz-border-radius:0 4px 4px 0;-o-border-radius:0 4px 4px 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;padding:11px 25px;display:inline-block;cursor:pointer;white-space:nowrap;vertical-align:top;border:1px solid #076ccc;background:url(http://shared.ydstatic.com/dict/youdaowap/changeImg/search.png) 13px 6px no-repeat #0082ff;box-sizing:border-box;-webkit-box-sizing:border-box;background-size:50%}.copy,.dict-dl{font-size:12px}.search-bar .selectedLang{display:table-cell;background:#fff;border:1px solid #d9d9d9;border-right:none;border-top-color:silver;border-radius:4px 0 0 4px;-webkit-border-radius:4px 0 0 4px;-moz-border-radius:4px 0 0 4px;-o-border-radius:4px 0 0 4px;color:#313131;width:1%;vertical-align:middle}.search-bar .selectedLang span{display:inline-block;width:30px;padding:0 7px}.search-area .lang-select-list{position:absolute;background:#fff;border:1px solid #d9d9d9;left:7px;top:51px;display:none}.search-area .lang-select-list li{padding:7px 22px;border-bottom:1px solid #d9d9d9;-webkit-tap-highlight-color:red}.page{border-radius:2px;-webkit-border-radius:2px;-moz-border-radius:2px;-o-border-radius:2px;border:1px solid #e1e1e1;background:#fff;display:block;color:#313131}.page a{width:49%;display:inline-block;padding:11px 0}.copy{color:#b2b2b2}.dict_sents_result .col3,.source{text-align:right}.copy a{margin:0 7px;color:#8f9dae}#suggest{position:absolute;top:53px;width:100%;padding:0 7px;box-sizing:border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box}#suggest .container{border:1px solid #D9D9D9;border-top:none;border-bottom:none}#suggest .container li{padding:7px 0;border-bottom:1px solid #D9D9D9;overflow:hidden;-webkit-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap;background:#fff;-webkit-tap-highlight-color:#ff0}#suggest .close{border:1px solid #D9D9D9;box-sizing:border-box;width:100%;border-top:none;background:#fff}#suggest .close a{display:inline-block;width:100%;padding:7px 0}#suggest .container li:active{background:#D8D8D8}#suggest .container:last-child{border-bottom:none}#suggest .container strong{margin:0 7px;color:#313131}.dict-container{background:#fff}.dict-container h4{border-bottom:1px solid #e1e1e1;padding:0 7px}.dict-container .trans-container{padding:7px}.dict-container .trans-title{display:block;padding:7px 0;color:#313131}.opened .trans-container{display:block}.closed .trans-container{display:none}.opened .trans-title{background:url(http://shared.ydstatic.com/dict/youdaowap/icon/dict_up_icon.png) right 0 no-repeat}.closed .trans-title{background:url(http://shared.ydstatic.com/dict/youdaowap/icon/dict_down_icon.png) right 0 no-repeat}.dict-dl{display:block;padding:7px;border:1px solid #E1E1E1;background-color:#FAFAFA}.core,.secondary,.secondaryFont{font-size:15px}#dictNav{top:350px;-webkit-transition:top .3s;transition:top .3s}#dictNavBtn{display:inline-block;background:url(http://shared.ydstatic.com/dict/youdaowap/changeImg/dict_unfold_icon_normal.png) no-repeat;background-size:100%;width:48px;height:0;padding-top:48px;overflow:hidden}#dictNavBtn.selected{background:url(http://shared.ydstatic.com/dict/youdaowap/changeImg/dict_unfold_icon_pressed.png) no-repeat;background-size:100%}#dictNavList{bottom:49px;height:0;width:200px;background:rgba(0,0,0,.7);overflow-y:scroll;display:none;-webkit-transition:height .5s}#dictNavList li{padding:7px 0;border-bottom:1px solid rgba(255,255,255,.3)}#dictNavList li a{color:#fff;display:inline-block;width:100%;box-sizing:border-box;padding:0 7px}.core,body{color:#4e4c4a}body{-webkit-touch-callout:none}h2{margin:0;padding:0}.secondary{color:#847965}.emphasis,b{color:#9c0;font-style:italic}.clickable{color:#279aec}.grey{color:#847965}.serial{margin-right:.7em}.source{padding-top:.7em}.mcols-layout{overflow:hidden}.mcols-layout .col1{width:1.33em;float:left}.mcols-layout .col2{overflow:auto}.mcols-layout .col3{vertical-align:top;float:right}a.pronounce{display:inline-block;text-indent:-9999px;font-size:0;width:24px;height:24px;background-image:url(http://shared.ydstatic.com/dict/youdaowap/icon/dict_pronounce-_icon_normal.png);background-size:24px 24px}a.pronounce:active{background-image:url(http://shared.ydstatic.com/dict/youdaowap/icon/dict_pronounce-_icon_pressed.png)}a.pronounce.disbled{background-image:url(http://shared.ydstatic.com/dict/youdaowap/icon/dict_pronounce-_icon_disable.png)}.ec a.pronounce{vertical-align:middle}.dict-container .trans-container h4{border:none;padding:0;-webkit-tap-highlight-color:#ff0}.dict-container .dict_sents_result{padding:0}.dict-container .dict_sents_result .content{padding:7px}.dict_sents_result .clickable{font-size:13px}.dict_sents_result li{padding-top:.6em}.dict_sents_result li:first-child{padding-top:0}.dict_sents_result .speech-size{margin-top:-10px}.dict_sents_result .more-sents{display:block;padding:7px}.collins .star{background:url(http://shared.ydstatic.com/dict/youdaowap/icon/dict_star_live.png);display:inline-block;overflow:hidden;height:13px;width:77px;background-size:77px 13px;margin:0 7px}.collins .star1{width:14px}.collins .star2{width:28px}.collins .star3{width:45px}.collins .star4{width:61px}.collins .star5{width:77px}.cj .colExam,.ck .colExam,.jc .colExam,.kc .colExam{width:3em}.collins .per-collins-entry li{padding:.6em 0 0}.collins li .mcols-layout{padding:.4em 0 0}.collins h4 .title{overflow:hidden}.ec h2{margin-bottom:.7em;font-size:16px;line-height:1.5em}.ec h2 .amend{float:right;text-decoration:underline}.ec h2 span{display:inline-block}.ec .sub{margin-top:.7em;padding-top:.7em}.ec .core{padding-left:.33em}.web_trans .webPhrase{margin-top:.6em}.web_trans .trans-list>li{padding:.6em 0 0}.web_trans .trans-list>li:first-child{padding-top:0}ce_new .trans-list li{padding:.7em 0 0}.ce_new .source,.ce_new>ul .per-tran{padding:.7em 0}.ce_new>ul .per-tran:first-child{border:none}.cj>ul,.ck>ul{padding-bottom:.7em}.cj h4{font-weight:700}.cj .grey{font-weight:400}.cj>h4{padding-top:.7em}.cj>h4:first-child{padding-top:0}.ck>h4{padding-top:.7em}.ck>h4:first-child{padding-top:0}.ec21 .phrs,.ec21 .posType>li,.ec21 .source,.ec21 .wfs,.ee>ul>li{padding:.7em 0}.ec21 ins{color:#b6afa2;margin:0 .5em;text-decoration:none}.ec21 .serial{margin-right:.7em}.ee .per-tran,.hh>ul li{padding:.3em 0}.ee>ul{margin-top:.7em}.fanyi{overflow:hidden}.hh>h4{padding-top:.7em}.hh>h4:first-child{padding-top:0}.hh .source{padding:.7em 0}.jc h4{font-weight:700}.jc .origin,.jc sup{font-weight:400}.jc .origin{font-size:.86em}.kc h4{font-weight:700}.loading{padding:2em;color:#4e4c4a}.rel_word>ul li{padding:.3em 0}.rel_word>ul li:first-child{padding-top:0}.special>ul>li{padding:.7em 0}.special>ul>li:first-child{padding-top:0}.special .source{padding:.7em 0}.syno>ul li{padding:.3em 0}.syno>ul li:first-child{padding-top:0}.baike .target{display:block;position:relative;padding-right:40px}.baike .source,.baike>ul li{padding:.7em 0}.baike>ul li:first-child{padding-top:0}.typo .clickable{margin-right:7px}.typo li{padding:7px 0 0}.baike_detail>h4{font-size:24px;padding:0 0 .5em}.baike_detail li{padding:.5em 0}.baike_detail p{margin-bottom:.5em}.baike_detail p:first-child{padding-bottom:.5em}.baike_detail .grey{display:block;padding:.8em 0}.baike_detail .img{clear:both;display:block;font-size:12px;font-weight:400;line-height:18px;overflow:hidden;width:auto!important}.baike_detail .img_r{float:right;margin-left:1em}.baike_detail img{width:88px;height:auto;-webkit-border-radius:3px}.baike_detail .img strong{display:none}.baike_detail strong{display:block;padding:.5em 0}.baike_detail a,.baike_detail a b{color:#279aec}</style>
'''
